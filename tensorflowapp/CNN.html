<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
<script lang="js">
    async function run() {

        model = tf.sequential();

        // Input layer with image 28x28x1, maxPooling, more conv2d, maxPooling and finally with flatten
        model.add(tf.layers.conv2d({
            inputShape: [28, 28, 1],
            kernelSize: 3,
            filters: 8,
            activation: 'relu' // filter out values less than 0
        }));
        model.add(tf.layers.maxPooling2d({
            poolSize: [2, 2]
        }));
        model.add(tf.layers.conv2d({
            kernelSize: 3,
            filters: 16,
            activation: 'relu'
        }));
        model.add(tf.layers.maxPooling2d({
            poolSize: [2, 2]
        }));
        model.add(tf.layers.flatten()); // make 28x28x1 to 1Dimension array
        // hidden layer
        model.add(tf.layers.dense({
            units: 128,
            activation: 'relu'
        }));
        // Output layers
        model.add(tf.layers.dense({
            units: 10,
            activation: 'softmax'
        }));

        // Optimize 
        model.compile({
            optimizer: tf.train.adam(),
            loss: 'categoricalCrossentropy',
            metrics: ['accuracy']
        })

        const metrics = ['loss', 'val_loss', 'acc', 'val_acc'];
        const container = {
            name: 'Model training',
            styles: {
                height: '1000px'
            }
        };
        const fitCallbacks = tfvis.show.fitCallbacks(container, metrics);

    };
    run();
</script>

<body>

</body>

</html>